# SagraFacile WebApp Frontend

This project contains the frontend web application for the SagraFacile system, built with Next.js and TypeScript.

## Overview

This single Next.js application serves multiple interfaces for the SagraFacile system:

*   **Public Interfaces:**
    *   Customer Pre-Ordering (`/preorder/[orgSlug]/[areaSlug]`)
*   **Internal Interfaces:** Accessible only on the local network for staff:
    *   Cashier Station (`/app/org/[orgId]/cashier`)
    *   Admin Dashboard (CRUD for Orgs, Areas, Menu, Users, KDS Stations) (`/app/org/[orgId]/admin/...`)
    *   Kitchen Display System (KDS) (`/app/org/[orgId]/area/[areaId]/kds/[kdsId]`) - See `../../KdsArchitecture.md` for details.
    *   Waiter Interface (`/app/org/[orgId]/waiter`) - See `../../WaiterArchitecture.md` for details.
    *   SuperAdmin Management
    *   Password Reset (`/app/forgot-password`, `/app/reset-password`)
    *   User Invitation Management (`/app/org/[orgId]/admin/users` - for admins to invite and manage pending invitations)

It interacts with the SagraFacile .NET Backend API for data and business logic.

## Tech Stack

*   **Framework:** Next.js (v14+ with App Router)
*   **Language:** TypeScript
*   **Styling:** Tailwind CSS
*   **UI Components:** Shadcn/ui (using Zinc as the base color)
*   **State Management:** React Context API (`AuthContext`, `OrganizationContext`, `SessionContext`)
*   **API Client:** Custom `fetch` wrapper (`src/services/apiClient.ts`)
*   **Real-time:** @microsoft/signalr client (to be added for Kitchen Display)
*   **QR Codes:** Generated by the backend (`QRCoder`) for pre-order confirmation emails. Frontend does not currently generate QR codes.

## Project Structure

*   `src/app/`: Main application routes using Next.js App Router.
    *   `src/app/layout.tsx`: Root layout.
    *   `src/app/page.tsx`: Default landing page (can be customized or removed).
    *   `src/app/globals.css`: Global styles (includes Tailwind base/utilities and Shadcn/ui theme variables).
    *   `src/app/api/`: API routes (if needed for frontend-specific server functions).
    *   `(public)/`: Route group for public-facing pages (e.g., `/preorder/[orgSlug]/[areaSlug]`, `/preorder/success`).
    *   `app/`: Route group for internal, authenticated pages (e.g., `/app/login`, `/app/org/[orgId]/cashier`, `/app/org/[orgId]/admin/...`).
*   `src/components/`: Reusable UI components (including Shadcn/ui components like `OrderTable`, `ReceiptDialog`).
*   `src/lib/`: Utility functions (e.g., `utils.ts` from Shadcn/ui).
*   `src/contexts/`: React Context API providers and hooks.
*   `src/hooks/`: Custom React hooks.
*   `src/services/`: API interaction logic (API client wrapper).
*   `public/`: Static assets.
*   `tailwind.config.ts`: Tailwind CSS configuration.
*   `postcss.config.mjs`: PostCSS configuration.
*   `tsconfig.json`: TypeScript configuration.
*   `next.config.mjs`: Next.js configuration.
*   `package.json`: Project dependencies and scripts.
*   `components.json`: Shadcn/ui configuration.

can read from ApiRoutes.md and DataStructures.md to understand API routes and objects

*(Note: Directory structure will evolve as the application grows)*

## Getting Started

### Prerequisites

*   Node.js (Check `.nvmrc` or `package.json` engines field if specified, otherwise use a recent LTS version)
*   npm (comes with Node.js)

### Installation

1.  Navigate to the project directory:
    ```bash
    cd sagrafacile-webapp
    ```
2.  Install dependencies:
    ```bash
    npm install
    ```
    *(If you encounter peer dependency issues with React 19, you might need `npm install --legacy-peer-deps`)*

### Running the Development Server

1.  Ensure the SagraFacile .NET Backend API is running.
2.  Configure the API base URL: Create a `.env.local` file in the `sagrafacile-webapp` root directory and add the following line, replacing the URL with the actual address of your running backend API (likely via the reverse proxy):
    ```
    NEXT_PUBLIC_API_BASE_URL=http://localhost:5059/api
    ```
    *(Adjust the port if necessary)*
3.  Start the Next.js development server:
    ```bash
    npm run dev
    ```
4.  Open [http://localhost:3000](http://localhost:3000) (or the specified port) in your browser.

### Building for Production

```bash
npm run build
```

### Running in Production Mode

```bash
npm start
```

## Key Scripts

*   `npm run dev`: Starts the development server.
*   `npm run build`: Creates a production build.
*   `npm start`: Starts the production server (requires `npm run build` first).
*   `npm run lint`: Runs ESLint to check for code style issues.

## Contributing

(To be defined)

## License

Refer to the main `LICENSE.txt` file in the root of the SagraFacile repository.
